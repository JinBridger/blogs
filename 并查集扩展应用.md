# 并查集扩展应用
### 边带权的并查集
有些时候我们需要维护不重叠集合内元素的距离，此时便引入了边带权的并查集。

```
有一个划分成 N 列的星际战场，各列依次编号为 1, 2, ... N .有 N 艘战舰，也依次编号为 1, 2, ... N .其中第 i 号战舰处于第 i 列。
有 M 条指令，每条指令为以下两种格式之一：
1. M i j 表示让第 i 号战舰所在列的全部战舰保持原有顺序，接在第 j 号战舰所在列的尾部。
2. C i j 表示询问第 i 号与第 j 号战舰是否处在同一列中，如果处于同一列，则输出它们之间的战舰数。( NOI 2002 / Luogu P1196)
```

显然的，这些战舰组成了不重叠的集合，我们在维护这些战舰的集合关系的同时，还要维护它们之间的距离。很明显，每条战舰之间的距离为 $1$ .因此两条战舰之间的距离便是它们与对前方战舰的距离之差减一。

定义 $d[i]$ 表示第 $i$ 条战舰与其所在列战舰之间的距离。初始化 $d[i] = 0$ , 进行合并时，令接在后面的战舰的 $d[i]$ 等于前一个元素所在列的战舰数 $size[i]$ .通过维护 $d$ 与 $size$ 数组实现带权并查集。

伪代码：

$\textbf{GET(x)}$
$\textbf{if}\ \ x = fa[x]$
$\ \ \ \ \textbf{return} x$
$root \leftarrow GET(fa[x])$
$d[x] \leftarrow d[x] + d[fa[x]]$
$fa[x] \leftarrow root$
$\textbf{return}\ \ fa[x]$


$\textbf{MERGE(x, y)}$
$x \leftarrow GET(x)$
$y \leftarrow GET(y)$
$fa[x] \leftarrow y$
$d[x] \leftarrow size[y]$
$size[y] \leftarrow size[y] + size[x]$