# 正则表达式小结

## 1. 正则表达式的结构

例如：
```shell
/^[a-z]*[^\d]{1,10}?(aaa|bbb)(?:ccc)$/g
```
其中 `/ /` 之间的为表达式的主体， 末尾的 `g` 为修饰符，正则表达式主体即为我们要匹配的对象。

## 2. 正则表达式主体的含义
### 2.1 简单字符
简单字符就是没有特殊意义的字符，作用与我们平日里使用的查找一样。它是什么就匹配什么。

```shell
/abc/ -> abc
/123/ -> 123
```

### 2.2 转义字符
与 Markdown 类似，正则表达式也有转义字符。

下面是转义字符表

| 转义字符  | 含义                                   |
| -------- | ---------------------------------------- |
| `\n`     | 匹配换行符                          |
| `\r`     | 匹配回车符                          |
| `\t`     | 匹配制表符 ( Tab )                  |
| `\v`     | 匹配垂直制表符                    |
| `\xNum`  | 匹配 2 位 16 进制数字             |
| `\uNum`  | 匹配 4 位 16 进制数字             |
| `\w`     | 匹配任何一个字母、数字、下划线 |
| `\W`     | 匹配任何一个除了字母、数字、下划线的字符 |
| `\s`     | 匹配空白字符 ( Tab , 空格 )      |
| `\S`     | 匹配非空白字符                    |
| `\d`     | 匹配一个数字字符                 |
| `\D`     | 匹配一个非数字字符              |
| `\b`     | 匹配单词的边界                    |
| `\B`     | 匹配非单词边界                    |
| `\\`     | 匹配 \ 本身                          |
| `\{`     | 匹配 { 本身                          |
| `\(`     | 匹配 ( 本身                          |
| `\)`     | 匹配 ) 本身                          |
| `\|`     | 匹配 | 本身                          |
| `\[`     | 匹配 [ 本身                          |
| `\$`     | 匹配 $ 本身                          |
| `\?`     | 匹配 ? 本身                          |
| `\.`     | 匹配 . 本身                          |
| `\^`     | 匹配 ^ 本身                          |
| `\*`     | 匹配 * 本身                          |


### 2.3 限定符（ 量词 ）

限定符一共有六种，用于指定匹配的次数。作用的范围为前面的单个字符或是 `[]` 内的字符串。例如 `ab*` 中 `*` 仅作用于 `b` 而 `[ab]*` 中 `*` 则作用于 `ab` 。

| 限定符  | 含义                                   |
| -------- | ---------------------------------------- |
| `*`     | 匹配前面的子表达式零次或多次。例如，zo* 能匹配 "z" 以及 "zoo"。* 等价于{0,} |
| `+`     | 匹配前面的子表达式一次或多次。例如，'zo+' 能匹配 "zo" 以及 "zoo"，但不能匹配 "z"。+ 等价于 {1,}|
| `?`     | 匹配前面的子表达式零次或一次。例如，"do(es)?" 可以匹配 "do" 、 "does" 中的 "does" 、 "doxy" 中的 "do" 。? 等价于 {0,1}，跟在限定符后面时表示优先匹配少的次数。 |
| `{n}`   | 	n 是一个非负整数。匹配确定的 n 次。例如，'o{2}' 不能匹配 "Bob" 中的 'o'，但是能匹配 "food" 中的两个 o |
| `{n,}`  | n 是一个非负整数。至少匹配n 次。例如，'o{2,}' 不能匹配 "Bob" 中的 'o'，但能匹配 "foooood" 中的所有 o。'o{1,}' 等价于 'o+'。'o{0,}' 则等价于 'o*' |
| `{n,m}` | 	m 和 n 均为非负整数，其中n <= m。最少匹配 n 次且最多匹配 m 次。例如，"o{1,3}" 将匹配 "fooooood" 中的前三个 o。'o{0,1}' 等价于 'o?'。请注意在逗号和两个数之间不能有空格。 |

### 2.4 特殊字符

 | 特殊字符  | 含义                                   |
| -------- | ---------------------------------------- |
| `$`     | 匹配输入字符串的结尾位置。 |
| `.`     | 	匹配除换行符 \n 之外的任何单字符。 |
| `^`     | 	匹配输入字符串的开始位置，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。 |
| `|`     | 	指明两项之间的一个选择。              |

### 2.5 中括号表达式与子表达式
#### 中括号表达式
`[内容]` 为中括号表达式，其作用相当于匹配其中任意一个字符。后面可以跟限定符。例如
```shell
[abc] -> a 或 b 或 c
[0-9] <-> [0123456789] -> 0 - 9 的单个数字
```

在中括号表达式中 `^` 代表非的意思，指匹配除表达式内任意字符。例如
```shell
[^abc] -> 除了 a, b, c 以外的所有字符
```

一般的：

```shell
. 匹配除了换行符（\n）以外的任意一个字符 -> [^\n]
\w -> [0-9a-Z_]
\W -> [^0-9a-Z_]
\s -> [ \t\n\v]
\S -> [^ \t\n\v]
\d -> [0-9]
\D -> [^0-9]
```

#### 子表达式
`(内容)` 为子表达式，其作用相当于匹配里面完整的内容。后面可以跟限定符。例如
```shell
(abc) -> abc
(abc)+ -> abc, abcabc, abcabcabc...
```

其中可以使用选择表达式 `|` 例如
```shell
(123|456) -> 123 或 456
```

### 2.6 正则表达式的贪婪原则
一般的，正则表达式在匹配时，都优先匹配量词的上限而不是下限。例如 `a{2,3}` 会优先匹配 `aaa` 而不是 `aa` .

如果需要优先匹配 `aa` 则需要在后面加上 `?` 表示优先匹配下限。

__简单的说，`?` 跟在 `}` 后面时表示优先匹配下限，除此以外，表示匹配一次或零次。__

### 2.7 预搜索

当需要查询不在某个字符串后面或前面的字符串时就需要预搜索。预搜索有四种：

```shell
exp1(?=exp2) -> 后面是 exp2 的 exp1
exp1(?!exp2) -> 后面不是 exp2 的 exp1
(?<=exp2)exp1 -> 前面是 exp2 的 exp1
(?<!exp2)exp1 -> 前面不是 exp2 的 exp1
```

注：后面两种可能有的语言不支持

## 3. 正则表达式的修饰符

正则表达式有三种修饰符 `i`, `m`, `g`.

`i` 表示忽略 ( ignore ) 大小写

`m` 表示匹配多行 ( multiple ) 文本，而不是遇到换行符就结束

`g` 表示匹配全局 ( global ) 的文本，而不仅仅匹配第一个
